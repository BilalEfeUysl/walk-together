{% extends "base.html" %} {% block content %}
<div
  class="bg-background-light dark:bg-background-dark min-h-screen font-display transition-colors duration-300"
>
  <div
    class="layout-container flex flex-col lg:flex-row max-w-[1280px] mx-auto px-4 lg:px-8 py-8 gap-8"
  >
    <aside class="w-full lg:w-[360px] flex-shrink-0 flex flex-col gap-6">
      <div
        class="bg-white dark:bg-[#1e2a24] p-5 rounded-2xl shadow-sm border border-transparent dark:border-[#2a382e] flex flex-col h-full max-h-[calc(100vh-100px)] sticky top-24"
      >
        <h3
          class="text-lg font-bold mb-4 flex items-center gap-2 text-[#131614] dark:text-white"
        >
          <span
            class="material-symbols-outlined text-primary dark:text-green-400"
            >person_search</span
          >
          Arkada≈ü Ara
        </h3>

        <form method="POST" class="relative w-full group flex gap-2 shrink-0">
          <div class="relative flex-1">
            <div
              class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
            >
              <span class="material-symbols-outlined text-gray-400"
                >search</span
              >
            </div>
            <input
              type="text"
              name="search_query"
              class="block w-full pl-10 pr-3 py-3 border-none rounded-xl bg-[#f6f8f7] dark:bg-[#2a382e] text-sm text-[#131614] dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-primary dark:focus:ring-green-500 transition-all"
              placeholder="Kullanƒ±cƒ± adƒ± girin..."
              required
            />
          </div>
          <button
            type="submit"
            class="px-4 py-2 bg-primary text-white rounded-xl text-sm font-bold hover:bg-primary-hover transition-colors"
          >
            Ara
          </button>
        </form>

        {% if search_results %}
        <div
          class="mt-4 flex flex-col gap-1 overflow-y-auto custom-scrollbar pr-1 flex-1 min-h-0"
        >
          <h6
            class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 sticky top-0 bg-white dark:bg-[#1e2a24] py-1 z-10"
          >
            Sonu√ßlar
          </h6>

          {% for user in search_results %}
          <div
            class="flex items-center justify-between p-2 hover:bg-[#f6f8f7] dark:hover:bg-[#2a382e] rounded-xl transition-colors group"
          >
            <a
              href="/profile/{{ user[0] }}"
              class="flex items-center gap-3 flex-1 min-w-0"
            >
              <img
                src="https://ui-avatars.com/api/?name={{ user[1] }}&background=random"
                class="size-10 rounded-full"
              />
              <div class="flex flex-col">
                <span
                  class="font-bold text-sm text-[#131614] dark:text-white group-hover:text-primary transition-colors"
                  >{{ user[1] }}</span
                >
                <span class="text-[10px] text-gray-400">Profili G√∂r</span>
              </div>
            </a>

            <a
              href="/add_friend/{{ user[0] }}"
              class="size-8 rounded-full bg-primary/10 text-primary hover:bg-primary hover:text-white flex items-center justify-center transition-colors shrink-0"
              title="Arkada≈ü Ekle"
            >
              <span class="material-symbols-outlined text-[18px]"
                >person_add</span
              >
            </a>
          </div>
          {% endfor %}
        </div>
        {% endif %} {% if suggestions and not search_results %}
        <div
          class="mt-6 flex flex-col gap-4 overflow-y-auto custom-scrollbar pr-1 flex-1 min-h-0"
        >
          <h3
            class="text-base font-bold text-gray-800 dark:text-gray-100 sticky top-0 bg-white dark:bg-[#1e2a24] py-1 z-10"
          >
            √ñnerilen Ki≈üiler
          </h3>

          {% for user in suggestions %}
          <div
            class="relative bg-white dark:bg-[#1e2a24] p-3 rounded-xl border border-gray-100 dark:border-[#2a382e] hover:border-primary/30 transition-all flex items-center gap-3"
          >
            <a href="/profile/{{ user[0] }}" class="relative shrink-0">
              <div
                class="size-12 rounded-full bg-cover bg-center"
                style="background-image: url('{{ user[2] or 'https://ui-avatars.com/api/?name=' ~ user[1] }}');"
              ></div>
            </a>
            <div class="flex-1 min-w-0">
              <a
                href="/profile/{{ user[0] }}"
                class="text-sm font-bold truncate text-[#131614] dark:text-white hover:underline"
                >{{ user[1] }}</a
              >
              <p class="text-xs text-gray-500 dark:text-gray-400 truncate">
                Doƒüa Sever
              </p>
            </div>
            <a
              href="/add_friend/{{ user[0] }}"
              class="size-8 rounded-full bg-primary text-white flex items-center justify-center hover:bg-primary-hover transition-colors shadow-sm"
              title="Ekle"
            >
              <span class="material-symbols-outlined text-[18px]">add</span>
            </a>
          </div>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </aside>

    <main class="flex-1 flex flex-col gap-6 min-w-0">
      <div class="border-b border-gray-200 dark:border-[#2a382e] pb-4">
        <h1
          class="text-3xl font-black tracking-tight text-[#131614] dark:text-white"
        >
          Arkada≈ülar
        </h1>
      </div>

      {% if pending_requests %}
      <div
        class="bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-100 dark:border-yellow-900/30 rounded-2xl p-4"
      >
        <h2
          class="text-sm font-bold text-yellow-800 dark:text-yellow-400 mb-3 flex items-center gap-2"
        >
          <span class="material-symbols-outlined filled text-[18px]"
            >notifications_active</span
          >
          Bekleyen ƒ∞stekler ({{ pending_requests|length }})
        </h2>
        <div class="grid gap-3 sm:grid-cols-2">
          {% for req in pending_requests %}
          <div
            class="bg-white dark:bg-[#1e2a24] p-3 rounded-xl flex items-center gap-3 shadow-sm"
          >
            <img
              src="https://ui-avatars.com/api/?name={{ req[1] }}&background=random"
              class="size-10 rounded-full"
            />
            <div class="flex-1 min-w-0">
              <p
                class="font-bold text-sm text-[#131614] dark:text-white truncate"
              >
                {{ req[1] }}
              </p>
            </div>
            <div class="flex gap-2">
              <a
                href="/accept_friend/{{ req[0] }}"
                class="p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors"
                title="Kabul Et"
              >
                <span class="material-symbols-outlined text-[18px]">check</span>
              </a>
              <a
                href="/reject_friend/{{ req[0] }}"
                class="p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors"
                title="Reddet"
                onclick="return confirm('ƒ∞steƒüi reddetmek istediƒüine emin misin?');"
              >
                <span class="material-symbols-outlined text-[18px]">close</span>
              </a>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5">
        {% for friend in my_friends %}
        <div
          class="bg-white dark:bg-[#1e2a24] rounded-xl p-5 shadow-sm hover:shadow-md border border-transparent hover:border-primary/20 dark:hover:border-green-500/20 hover:-translate-y-1 transition-all duration-300 flex flex-col gap-4 group relative"
        >
          <div class="flex items-start justify-between">
            <a
              href="/profile/{{ friend[2] }}"
              class="size-16 rounded-2xl bg-cover bg-center shadow-inner ring-2 ring-white dark:ring-[#1e2a24]"
              style="background-image: url('{{ friend[1] or 'https://ui-avatars.com/api/?name=' ~ friend[0] }}');"
            >
            </a>

            <a
              href="/remove_friend/{{ friend[2] }}"
              onclick="return confirm('{{ friend[0] }} adlƒ± ki≈üiyi √ßƒ±karmak istediƒüine emin misin?');"
              class="flex items-center justify-center size-8 rounded-lg bg-red-50 text-red-500 hover:bg-red-500 hover:text-white transition-all shadow-sm"
              title="Arkada≈ülƒ±ktan √áƒ±kar"
            >
              <span class="material-symbols-outlined text-[18px]"
                >person_remove</span
              >
            </a>
          </div>

          <div>
            <h3
              class="font-bold text-lg text-[#131614] dark:text-white truncate"
            >
              {{ friend[0] }}
            </h3>
            <p class="text-xs font-medium text-gray-500 dark:text-gray-400">
              Doƒüa Tutkunu üå≤
            </p>
          </div>

          <a
            href="/profile/{{ friend[2] }}"
            class="w-full mt-auto py-2.5 rounded-lg border border-gray-200 dark:border-[#2a382e] text-sm font-bold text-gray-700 dark:text-gray-200 hover:bg-[#f6f8f7] dark:hover:bg-[#2a382e] hover:border-primary/30 transition-all flex items-center justify-center gap-2"
          >
            <span class="material-symbols-outlined text-[18px]"
              >account_circle</span
            >
            Profili G√∂r
          </a>
        </div>
        {% else %}
        <div
          class="col-span-full py-16 text-center border-2 border-dashed border-gray-200 dark:border-[#2a382e] rounded-xl bg-gray-50/50 dark:bg-[#1e2a24]/50"
        >
          <div
            class="inline-flex items-center justify-center size-16 rounded-full bg-white dark:bg-[#2a382e] mb-4 text-gray-400 shadow-sm"
          >
            <span class="material-symbols-outlined text-3xl">group_add</span>
          </div>
          <h3 class="text-lg font-bold text-gray-800 dark:text-white">
            Hen√ºz Arkada≈üƒ±n Yok
          </h3>
          <p
            class="text-sm text-gray-500 dark:text-gray-400 mt-1 max-w-xs mx-auto"
          >
            Sol taraftaki arama kutusunu kullanarak yeni y√ºr√ºy√º≈ü arkada≈ülarƒ±
            bulabilirsin!
          </p>
        </div>
        {% endfor %}
      </div>
    </main>
  </div>
</div>
{% endblock %}
